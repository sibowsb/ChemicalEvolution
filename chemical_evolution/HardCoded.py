import numpy as np


def calc_rate(T, rx):
    T_eV = T / 11605.
    log_T = np.log(T)
    log_T_eV = np.log(T_eV)
    if rx == 1:
        rate = np.exp(- 32.71396786375
                      + 13.53655609057 * log_T_eV
                      - 5.739328757388 * log_T_eV ** 2
                      + 1.563154982022 * log_T_eV ** 3
                      - 0.2877056004391 * log_T_eV ** 4
                      + 0.03482559773736999 * log_T_eV ** 5
                      - 0.00263197617559 * log_T_eV ** 6
                      + 0.0001119543953861 * log_T_eV ** 7
                      - 2.039149852002e-6 * log_T_eV ** 8)
    elif rx == 2:
        rate = 4.881357e-6 * T ** (-1.5) * (1. + 1.14813e2 * T ** (-0.407)) ** (-2.242)
    elif rx == 3:
        rate = np.exp(- 44.09864886561001
                      + 23.91596563469 * log_T_eV
                      - 10.75323019821 * log_T_eV ** 2
                      + 3.058038757198 * log_T_eV ** 3
                      - 0.5685118909884001 * log_T_eV ** 4
                      + 0.06795391233790001 * log_T_eV ** 5
                      - 0.005009056101857001 * log_T_eV ** 6
                      + 0.0002067236157507 * log_T_eV ** 7
                      - 3.649161410833e-6 * log_T_eV ** 8)
    elif rx == 4:
        rate = (1.54e-9 * (1. + 0.3 / np.exp(8.099328789667 / T_eV)) /
                (np.exp(40.49664394833662 / T_eV) * T_eV ** 1.5)
                + 3.92e-13 / T_eV ** 0.6353)
    elif rx == 5:
        rate = np.exp(-68.71040990212001
                      + 43.93347632635 * log_T_eV
                      - 18.48066993568 * log_T_eV ** 2
                      + 4.701626486759002 * log_T_eV ** 3
                      - 0.7692466334492 * log_T_eV ** 4
                      + 0.08113042097303 * log_T_eV ** 5
                      - 0.005324020628287001 * log_T_eV ** 6
                      + 0.0001975705312221 * log_T_eV ** 7
                      - 3.165581065665e-6 * log_T_eV ** 8)

    elif rx == 6:
        rate = 7.8155e-5 * T ** (-1.5) * (1. + 2.0189e2 * T ** (-0.407)) ** (-2.242)

    elif rx == 7:
        rate = 3.0e-16 * (T / 3e2) ** 0.95 * np.exp(-T / 9.32e3)

    elif rx == 8:
        rate = 1.35e-9 * (T ** 9.8493e-2 + 3.2852e-1 * T ** 5.5610e-1 + 2.771e-7 * T ** 2.1826) \
               / (1. + 6.191e-3 * T ** 1.0461 + 8.9712e-11 * T ** 3.0424 + 3.2576e-14 * T ** 3.7741)

    elif rx == 9:
        rate = 2.10e-20 * (T / 30.0) ** (-0.15)

    elif rx == 10:
        rate = 6.0e-10 * np.ones_like(T)

    elif rx == 11:
        rate = (np.exp(-21237.15 / T)
                * (- 3.3232183e-07
                   + 3.3735382e-07 * log_T
                   - 1.4491368e-07 * log_T ** 2
                   + 3.4172805e-08 * log_T ** 3
                   - 4.7813720e-09 * log_T ** 4
                   + 3.9731542e-10 * log_T ** 5
                   - 1.8171411e-11 * log_T ** 6
                   + 3.5311932e-13 * log_T ** 7))

    elif rx == 12:
        rate = 4.4886e-9 * T ** 0.109127 * np.exp(-101858. / T)

    elif rx == 13:
        rate = 1.0670825e-10 * T_eV ** 2.012 / (np.exp(4.463 / T_eV) * (1. + 0.2472 * T_eV) ** 3.512)

    elif rx == 14:
        rate = np.exp(-18.01849334273
                      + 2.360852208681 * log_T_eV
                      - 0.2827443061704 * log_T_eV ** 2
                      + 0.01623316639567 * log_T_eV ** 3
                      - 0.03365012031362999 * log_T_eV ** 4
                      + 0.01178329782711 * log_T_eV ** 5
                      - 0.001656194699504 * log_T_eV ** 6
                      + 0.0001068275202678 * log_T_eV ** 7
                      - 2.631285809207e-6 * log_T_eV ** 8)

    elif rx == 15:
        rate = np.exp(-20.37260896533324
                      + 1.139449335841631 * log_T_eV
                      - 0.1421013521554148 * log_T_eV ** 2
                      + 0.00846445538663 * log_T_eV ** 3
                      - 0.0014327641212992 * log_T_eV ** 4
                      + 0.0002012250284791 * log_T_eV ** 5
                      + 0.0000866396324309 * log_T_eV ** 6
                      - 0.00002585009680264 * log_T_eV ** 7
                      + 2.4555011970392e-6 * log_T_eV ** 8
                      - 8.06838246118e-8 * log_T_eV ** 9)

    elif rx == 16:
        rate = 2.4e-6 * (1. + T / 2e4) / np.sqrt(T)

    elif rx == 17:
        rate = 1e-8 * T ** (-0.4)

    elif rx == 18:
        rate = 1e-8 * np.ones_like(T)

    elif rx == 19:
        rate = 5e-7 * np.sqrt(100. / T)

    else:
        rate = 0 * np.ones_like(T)

    return rate
